{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///Users/viniciusbaldochi/despasys/src/app/api/fipe/veiculo/%5Btipo%5D/%5Bmarca%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ tipo: string; marca: string }> }\n) {\n  try {\n    const { tipo, marca } = await params;\n    const { searchParams } = new URL(request.url);\n    \n    // Validar tipo de veículo\n    const tiposValidos = ['carros', 'motos', 'caminhoes'];\n    if (!tiposValidos.includes(tipo)) {\n      return NextResponse.json(\n        { \n          error: 'Tipo de veículo inválido. Use: carros, motos ou caminhoes',\n          code: 'INVALID_VEHICLE_TYPE' \n        },\n        { status: 400 }\n      );\n    }\n\n    if (!marca) {\n      return NextResponse.json(\n        { \n          error: 'Código da marca é obrigatório',\n          code: 'BRAND_CODE_REQUIRED' \n        },\n        { status: 400 }\n      );\n    }\n\n    // Parâmetros opcionais\n    const tabelaReferencia = searchParams.get('tabela_referencia');\n    \n    let url = `https://brasilapi.com.br/api/fipe/veiculos/v1/${tipo}/${marca}`;\n    if (tabelaReferencia) {\n      url += `?tabela_referencia=${tabelaReferencia}`;\n    }\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n      },\n      signal: AbortSignal.timeout(15000)\n    });\n\n    if (response.status === 404) {\n      return NextResponse.json(\n        { \n          error: 'Veículos não encontrados para esta marca',\n          code: 'VEHICLES_NOT_FOUND' \n        },\n        { status: 404 }\n      );\n    }\n\n    if (response.status === 504) {\n      return NextResponse.json(\n        { \n          error: 'Serviço FIPE temporariamente indisponível. Tente novamente em alguns minutos.',\n          code: 'SERVICE_UNAVAILABLE' \n        },\n        { status: 503 }\n      );\n    }\n\n    if (!response.ok) {\n      return NextResponse.json(\n        { \n          error: 'Erro ao buscar veículos FIPE',\n          code: 'API_ERROR' \n        },\n        { status: response.status }\n      );\n    }\n\n    const veiculos = await response.json();\n    \n    return NextResponse.json({ \n      veiculos,\n      tipo,\n      marca,\n      total: Array.isArray(veiculos) ? veiculos.length : 1,\n      timestamp: new Date().toISOString()\n    });\n\n  } catch (error) {\n    console.error('Erro na API FIPE veículos:', error);\n    \n    if (error instanceof Error && error.name === 'AbortError') {\n      return NextResponse.json(\n        { \n          error: 'Timeout: Serviço FIPE demorou muito para responder. Tente novamente.',\n          code: 'TIMEOUT' \n        },\n        { status: 408 }\n      );\n    }\n\n    return NextResponse.json(\n      { \n        error: 'Erro interno do servidor',\n        code: 'INTERNAL_ERROR' \n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe,IACpB,OAAoB,EACpB,EAAE,MAAM,EAAwD;IAEhE,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAC9B,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAE5C,0BAA0B;QAC1B,MAAM,eAAe;YAAC;YAAU;YAAS;SAAY;QACrD,IAAI,CAAC,aAAa,QAAQ,CAAC,OAAO;YAChC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,OAAO;YACV,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,mBAAmB,aAAa,GAAG,CAAC;QAE1C,IAAI,MAAM,CAAC,8CAA8C,EAAE,KAAK,CAAC,EAAE,OAAO;QAC1E,IAAI,kBAAkB;YACpB,OAAO,CAAC,mBAAmB,EAAE,kBAAkB;QACjD;QAEA,MAAM,WAAW,MAAM,MAAM,KAAK;YAChC,QAAQ;YACR,SAAS;gBACP,UAAU;YACZ;YACA,QAAQ,YAAY,OAAO,CAAC;QAC9B;QAEA,IAAI,SAAS,MAAM,KAAK,KAAK;YAC3B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,SAAS,MAAM,KAAK,KAAK;YAC3B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAEA,MAAM,WAAW,MAAM,SAAS,IAAI;QAEpC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB;YACA;YACA;YACA,OAAO,MAAM,OAAO,CAAC,YAAY,SAAS,MAAM,GAAG;YACnD,WAAW,IAAI,OAAO,WAAW;QACnC;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAE5C,IAAI,iBAAiB,SAAS,MAAM,IAAI,KAAK,cAAc;YACzD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,MAAM;QACR,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}