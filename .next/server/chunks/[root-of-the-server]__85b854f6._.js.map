{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":["file:///Users/viniciusbaldochi/despasys/src/app/api/fipe/precos-reais/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { tipoVeiculo, codigoMarca, modeloNome } = body;\n\n    if (!tipoVeiculo || !codigoMarca || !modeloNome) {\n      return NextResponse.json(\n        { \n          error: 'Parâmetros obrigatórios: tipoVeiculo, codigoMarca, modeloNome',\n          code: 'MISSING_PARAMETERS' \n        },\n        { status: 400 }\n      );\n    }\n\n    // Buscar modelos da marca para encontrar o código do modelo\n    const modelosResponse = await fetch(\n      `https://parallelum.com.br/fipe/api/v1/${tipoVeiculo}/marcas/${codigoMarca}/modelos`\n    );\n\n    if (!modelosResponse.ok) {\n      return NextResponse.json(\n        { \n          error: 'Erro ao buscar modelos FIPE',\n          code: 'FIPE_MODELS_ERROR' \n        },\n        { status: 500 }\n      );\n    }\n\n    const modelosData = await modelosResponse.json();\n    const modelo = modelosData.modelos.find((m: any) => \n      m.nome.toLowerCase().includes(modeloNome.toLowerCase()) ||\n      modeloNome.toLowerCase().includes(m.nome.toLowerCase())\n    );\n\n    if (!modelo) {\n      return NextResponse.json(\n        { \n          error: 'Modelo não encontrado na base FIPE',\n          code: 'MODEL_NOT_FOUND' \n        },\n        { status: 404 }\n      );\n    }\n\n    // Buscar anos disponíveis para o modelo\n    const anosResponse = await fetch(\n      `https://parallelum.com.br/fipe/api/v1/${tipoVeiculo}/marcas/${codigoMarca}/modelos/${modelo.codigo}/anos`\n    );\n\n    if (!anosResponse.ok) {\n      return NextResponse.json(\n        { \n          error: 'Erro ao buscar anos FIPE',\n          code: 'FIPE_YEARS_ERROR' \n        },\n        { status: 500 }\n      );\n    }\n\n    const anos = await anosResponse.json();\n\n    // Buscar preços para os últimos 3 anos para performance\n    const anosLimitados = anos.slice(0, 3);\n    const precosPromises = anosLimitados.map(async (ano: any) => {\n      try {\n        const precoResponse = await fetch(\n          `https://parallelum.com.br/fipe/api/v1/${tipoVeiculo}/marcas/${codigoMarca}/modelos/${modelo.codigo}/anos/${ano.codigo}`\n        );\n        \n        if (precoResponse.ok) {\n          return await precoResponse.json();\n        }\n        return null;\n      } catch {\n        return null;\n      }\n    });\n\n    const precos = (await Promise.all(precosPromises)).filter(Boolean);\n\n    return NextResponse.json({\n      success: true,\n      modelo: modelo.nome,\n      totalPrecos: precos.length,\n      precos,\n      timestamp: new Date().toISOString()\n    });\n\n  } catch (error) {\n    console.error('Erro na API FIPE preços:', error);\n    \n    return NextResponse.json(\n      { \n        error: 'Erro interno do servidor',\n        code: 'INTERNAL_ERROR' \n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,WAAW,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG;QAEjD,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,YAAY;YAC/C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,4DAA4D;QAC5D,MAAM,kBAAkB,MAAM,MAC5B,CAAC,sCAAsC,EAAE,YAAY,QAAQ,EAAE,YAAY,QAAQ,CAAC;QAGtF,IAAI,CAAC,gBAAgB,EAAE,EAAE;YACvB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,cAAc,MAAM,gBAAgB,IAAI;QAC9C,MAAM,SAAS,YAAY,OAAO,CAAC,IAAI,CAAC,CAAC,IACvC,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,WAAW,WAAW,OACpD,WAAW,WAAW,GAAG,QAAQ,CAAC,EAAE,IAAI,CAAC,WAAW;QAGtD,IAAI,CAAC,QAAQ;YACX,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,wCAAwC;QACxC,MAAM,eAAe,MAAM,MACzB,CAAC,sCAAsC,EAAE,YAAY,QAAQ,EAAE,YAAY,SAAS,EAAE,OAAO,MAAM,CAAC,KAAK,CAAC;QAG5G,IAAI,CAAC,aAAa,EAAE,EAAE;YACpB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBACE,OAAO;gBACP,MAAM;YACR,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,aAAa,IAAI;QAEpC,wDAAwD;QACxD,MAAM,gBAAgB,KAAK,KAAK,CAAC,GAAG;QACpC,MAAM,iBAAiB,cAAc,GAAG,CAAC,OAAO;YAC9C,IAAI;gBACF,MAAM,gBAAgB,MAAM,MAC1B,CAAC,sCAAsC,EAAE,YAAY,QAAQ,EAAE,YAAY,SAAS,EAAE,OAAO,MAAM,CAAC,MAAM,EAAE,IAAI,MAAM,EAAE;gBAG1H,IAAI,cAAc,EAAE,EAAE;oBACpB,OAAO,MAAM,cAAc,IAAI;gBACjC;gBACA,OAAO;YACT,EAAE,OAAM;gBACN,OAAO;YACT;QACF;QAEA,MAAM,SAAS,CAAC,MAAM,QAAQ,GAAG,CAAC,eAAe,EAAE,MAAM,CAAC;QAE1D,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,QAAQ,OAAO,IAAI;YACnB,aAAa,OAAO,MAAM;YAC1B;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAE1C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,MAAM;QACR,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}